<Window x:Class="MultiLogViewer.SearchWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:MultiLogViewer"
        mc:Ignorable="d"
        Title="Search" Height="28" Width="300"
        WindowStyle="None"
        ResizeMode="NoResize"
        ShowInTaskbar="False"
        AllowsTransparency="True"
        Background="Transparent">
    
    <Border Background="{StaticResource WindowBackgroundBrush}" 
            BorderBrush="{StaticResource BorderBrush}" 
            BorderThickness="1" 
            CornerRadius="4"
            Padding="2">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="10"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Drag Handle -->
            <Border Grid.Column="0" Background="Transparent" Cursor="SizeAll"/>

            <!-- Search Box -->
            <TextBox Grid.Column="1" 
                     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}" 
                     VerticalContentAlignment="Center"
                     Padding="2,0"
                     FontSize="12"
                     Margin="0,0,2,0">
                <TextBox.InputBindings>
                    <KeyBinding Key="Enter" Command="{Binding FindNextCommand}"/>
                    <KeyBinding Key="Enter" Modifiers="Shift" Command="{Binding FindPreviousCommand}"/>
                </TextBox.InputBindings>
            </TextBox>

            <!-- Status Text -->
            <TextBlock Grid.Column="2" 
                       Text="{Binding StatusText}"
                       VerticalAlignment="Center"
                       FontSize="11"
                       Foreground="Gray"
                       Margin="0,0,2,0"
                       MinWidth="20"
                       TextAlignment="Right"/>

            <!-- Case Sensitive Toggle -->
            <ToggleButton Grid.Column="3" 
                          IsChecked="{Binding IsCaseSensitive}"
                          ToolTip="Match Case"
                          Style="{StaticResource IconToggleButtonStyle}"
                          Width="22" Height="22" Margin="0,0,1,0">
                <TextBlock Text="Aa" FontWeight="Bold" FontSize="11"
                           Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ToggleButton}}"/>
            </ToggleButton>

            <!-- Regex Toggle -->
            <ToggleButton Grid.Column="4" 
                          IsChecked="{Binding IsRegex}"
                          ToolTip="Regular Expression"
                          Style="{StaticResource IconToggleButtonStyle}"
                          Width="22" Height="22" Margin="0,0,2,0">
                <TextBlock Text=".*" FontWeight="Bold" FontSize="14" Margin="0,-4,0,0"
                           Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ToggleButton}}"/>
            </ToggleButton>
            
            <!-- Find Previous -->
            <Button Grid.Column="5" 
                    Command="{Binding FindPreviousCommand}"
                    ToolTip="Find Previous (Shift+Enter)"
                    Style="{StaticResource IconButtonStyle}"
                    Width="22" Height="22" Margin="0,0,1,0">
                <Path Data="{StaticResource ArrowUpIconGeometry}" 
                      Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" 
                      Stretch="Uniform" Width="10" Height="10"/>
            </Button>

            <!-- Find Next -->
            <Button Grid.Column="6" 
                    Command="{Binding FindNextCommand}"
                    ToolTip="Find Next (Enter)"
                    Style="{StaticResource IconButtonStyle}"
                    Width="22" Height="22" Margin="0,0,2,0">
                <Path Data="{StaticResource ArrowDownIconGeometry}" 
                      Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" 
                      Stretch="Uniform" Width="10" Height="10"/>
            </Button>

            <!-- Close -->
            <Button Grid.Column="7" 
                    Command="{Binding CloseCommand}"
                    ToolTip="Close"
                    Style="{StaticResource IconButtonStyle}"
                    Width="18" Height="18">
                <Path Data="{StaticResource CloseIconGeometry}" 
                      Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}" 
                      Stretch="Uniform" Width="9" Height="9"/>
            </Button>
        </Grid>
    </Border>
</Window>