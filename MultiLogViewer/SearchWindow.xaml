<Window x:Class="MultiLogViewer.SearchWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:behaviors="clr-namespace:MultiLogViewer.Behaviors"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:local="clr-namespace:MultiLogViewer"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        Title="Search"
        Width="300"
        Height="28"
        AllowsTransparency="True"
        Background="Transparent"
        ResizeMode="NoResize"
        ShowInTaskbar="False"
        WindowStyle="None"
        mc:Ignorable="d">

    <Window.InputBindings>
        <KeyBinding Key="Escape" Command="{Binding CloseCommand}" />
    </Window.InputBindings>

    <Border Padding="2"
            Background="{StaticResource WindowBackgroundBrush}"
            BorderBrush="{StaticResource BorderBrush}"
            BorderThickness="1"
            CornerRadius="4">
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="10" />
                <ColumnDefinition Width="*" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
            </Grid.ColumnDefinitions>

            <!-- Drag Handle -->
            <Border Grid.Column="0"
                    behaviors:WindowDragBehavior.LeftButtonDrag="True"
                    Background="Transparent"
                    Cursor="SizeAll" />

            <!-- Search Box -->
            <TextBox Grid.Column="1"
                     Margin="0,0,2,0"
                     Padding="2,0"
                     VerticalContentAlignment="Center"
                     behaviors:FocusBehavior.FocusOnLoad="True"
                     behaviors:FocusBehavior.FocusOnWindowActivation="True"
                     FontSize="12"
                     Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}">
                <TextBox.InputBindings>
                    <KeyBinding Key="Enter" Command="{Binding FindNextCommand}" />
                    <KeyBinding Key="Enter"
                                Command="{Binding FindPreviousCommand}"
                                Modifiers="Shift" />
                </TextBox.InputBindings>
            </TextBox>

            <!-- Status Text -->
            <TextBlock Grid.Column="2"
                       MinWidth="20"
                       Margin="0,0,2,0"
                       VerticalAlignment="Center"
                       FontSize="11"
                       Foreground="Gray"
                       Text="{Binding StatusText}"
                       TextAlignment="Right" />

            <!-- Case Sensitive Toggle -->
            <ToggleButton Grid.Column="3"
                          Width="22"
                          Height="22"
                          Margin="0,0,1,0"
                          IsChecked="{Binding IsCaseSensitive}"
                          Style="{StaticResource IconToggleButtonStyle}"
                          ToolTip="Match Case">
                <TextBlock FontSize="11"
                           FontWeight="Bold"
                           Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ToggleButton}}"
                           Text="Aa" />
            </ToggleButton>

            <!-- Regex Toggle -->
            <ToggleButton Grid.Column="4"
                          Width="22"
                          Height="22"
                          Margin="0,0,2,0"
                          IsChecked="{Binding IsRegex}"
                          Style="{StaticResource IconToggleButtonStyle}"
                          ToolTip="Regular Expression">
                <TextBlock Margin="0,-4,0,0"
                           FontSize="14"
                           FontWeight="Bold"
                           Foreground="{Binding Foreground, RelativeSource={RelativeSource AncestorType=ToggleButton}}"
                           Text=".*" />
            </ToggleButton>

            <!-- Find Previous -->
            <Button Grid.Column="5"
                    Width="22"
                    Height="22"
                    Margin="0,0,1,0"
                    Command="{Binding FindPreviousCommand}"
                    Style="{StaticResource IconButtonStyle}"
                    ToolTip="Find Previous (Shift+Enter)">
                <Path Width="10"
                      Height="10"
                      Data="{StaticResource ArrowUpIconGeometry}"
                      Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                      Stretch="Uniform" />
            </Button>

            <!-- Find Next -->
            <Button Grid.Column="6"
                    Width="22"
                    Height="22"
                    Margin="0,0,2,0"
                    Command="{Binding FindNextCommand}"
                    Style="{StaticResource IconButtonStyle}"
                    ToolTip="Find Next (Enter)">
                <Path Width="10"
                      Height="10"
                      Data="{StaticResource ArrowDownIconGeometry}"
                      Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                      Stretch="Uniform" />
            </Button>

            <!-- Close -->
            <Button Grid.Column="7"
                    Width="18"
                    Height="18"
                    Command="{Binding CloseCommand}"
                    Style="{StaticResource IconButtonStyle}"
                    ToolTip="Close">
                <Path Width="9"
                      Height="9"
                      Data="{StaticResource CloseIconGeometry}"
                      Fill="{Binding Foreground, RelativeSource={RelativeSource AncestorType=Button}}"
                      Stretch="Uniform" />
            </Button>
        </Grid>
    </Border>
</Window>
